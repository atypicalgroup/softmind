<div class="dashboard py-4">

  <!-- üîπ Cabe√ßalho -->
  <div class="dashboard-header mb-4">
    <h2>Seja Bem-Estar, {{ nameEmployee }}</h2>
    <p class="text-muted">
      Monitoramento an√¥nimo da sa√∫de e comportamento organizacional.
    </p>
  </div>

  <!-- üîπ Mensagem de erro -->
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <!-- üîπ Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-success" role="status"></div>
    <p class="mt-2 text-muted">Carregando relat√≥rio...</p>
  </div>

  <!-- üîπ Conte√∫do principal -->
  <ng-container *ngIf="!loading && !error">

    <!-- KPIs -->
    <div class="kpi-cards row g-3 mb-4">
      <app-card
        title="Participa√ß√£o"
        description="Colaboradores ativos na pesquisa"
        [value]="participation"
        variable="‚Üë"
        color="green"
      ></app-card>

      <app-card
        title="Engajamento"
        description="N√≠vel m√©dio geral"
        [value]="engagement + '%'"
        variable="‚Üë"
        color="blue"
      ></app-card>

      <app-card
        title="Departamentos Engajados"
        description="Setores com participa√ß√£o"
        [value]="engagedDepartments"
        variable="‚Üë"
        color="green"
      ></app-card>

      <app-card
        title="Alertas"
        description="Indicadores cr√≠ticos"
        [value]="criticalAlerts"
        variable="‚Üì"
        color="red"
      ></app-card>
    </div>

    <!-- üîπ Gr√°fico geral de sentimentos -->
    <div class="card shadow-sm p-4 mb-4">
      <h5 class="mb-3">Distribui√ß√£o de Sentimentos</h5>
      <app-grafic
        *ngIf="labelList.length && dataList.length"
        [labels]="labelList"
        [data]="dataList"
        title="Distribui√ß√£o dos Sentimentos (%)"
      ></app-grafic>
    </div>


    <!-- üîπ Sentimentos -->
    <div class="card shadow-sm p-4 mb-4">
      <h5 class="mb-3">Sentimentos Relatados</h5>
      <ul class="list-group">
        <li
          *ngFor="let mood of moods"
          class="list-group-item d-flex justify-content-between align-items-center"
        >
          <span class="fw-semibold text-capitalize">{{ mood.name }}</span>
          <span
            class="badge bg-info text-dark"
            [ngClass]="{
              'bg-success': mood.name === 'happy',
              'bg-warning': mood.name === 'tired' || mood.name === 'anxious',
              'bg-danger': mood.name === 'sad' || mood.name === 'anger'
            }"
          >
            {{ mood.value }}%
          </span>
        </li>
      </ul>
    </div>

    <!-- üîπ Participa√ß√£o por setor -->
    <div class="card shadow-sm p-4 mb-4">
      <h5 class="mb-3">Engajamento por Setor</h5>
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Setor</th>
            <th>Participa√ß√£o</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of sectors">
            <td>{{ s.sector }}</td>
            <td>{{ s.participation }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- üîπ √öltimas Perguntas e Respostas -->
    <div *ngIf="latestQuestions?.length" class="card shadow-sm p-4">
      <h5 class="mb-3">√öltimas Respostas</h5>
      <table class="table table-hover align-middle">
        <thead>
          <tr>
            <th>Pergunta</th>
            <th>Resposta mais recente</th>
            <th>Data</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let q of latestQuestions">
            <td>{{ q.question }}</td>
            <td>{{ q.response }}</td>
            <td>{{ q.date | date: 'dd/MM/yyyy' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</div>
